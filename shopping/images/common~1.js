/**
 * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.
 *
 * @version 1.0.0
 * @codingstandard ftlabs-jsv2
 * @copyright The Financial Times Limited [All Rights Reserved]
 * @license MIT License (see LICENSE.txt)
 */

/*!
* jsUri
* https://github.com/derek-watson/jsUri
*
* Copyright 2013, Derek Watson
* Released under the MIT license.
*
* Includes parseUri regular expressions
* http://blog.stevenlevithan.com/archives/parseuri
* Copyright 2007, Steven Levithan
* Released under the MIT license.
*/

function FastClick(e){function n(e,t){return function(){return e.apply(t,arguments)}}var t;this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=10,this.layer=e;if(FastClick.notNeeded(e))return;deviceIsAndroid&&(e.addEventListener("mouseover",n(this.onMouse,this),!0),e.addEventListener("mousedown",n(this.onMouse,this),!0),e.addEventListener("mouseup",n(this.onMouse,this),!0)),e.addEventListener("click",n(this.onClick,this),!0),e.addEventListener("touchstart",n(this.onTouchStart,this),!1),e.addEventListener("touchmove",n(this.onTouchMove,this),!1),e.addEventListener("touchend",n(this.onTouchEnd,this),!1),e.addEventListener("touchcancel",n(this.onTouchCancel,this),!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,n,r){var i=Node.prototype.removeEventListener;t==="click"?i.call(e,t,n.hijacked||n,r):i.call(e,t,n,r)},e.addEventListener=function(t,n,r){var i=Node.prototype.addEventListener;t==="click"?i.call(e,t,n.hijacked||(n.hijacked=function(e){e.propagationStopped||n(e)}),r):i.call(e,t,n,r)}),typeof e.onclick=="function"&&(t=e.onclick,e.addEventListener("click",function(e){t(e)},!1),e.onclick=null)}var deviceIsAndroid=navigator.userAgent.indexOf("Android")>0,deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent),deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),deviceIsIOSWithBadTarget=deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent);FastClick.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(deviceIsIOS&&e.type==="file"||e.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(e.className)},FastClick.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!deviceIsAndroid;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},FastClick.prototype.sendClick=function(e,t){var n,r;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),r=t.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(this.determineEventType(e),!0,!0,window,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,e.dispatchEvent(n)},FastClick.prototype.determineEventType=function(e){return deviceIsAndroid&&e.tagName.toLowerCase()==="select"?"mousedown":"click"},FastClick.prototype.focus=function(e){var t;deviceIsIOS&&e.setSelectionRange&&e.type.indexOf("date")!==0&&e.type!=="time"?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},FastClick.prototype.updateScrollParent=function(e){var t,n;t=e.fastClickScrollParent;if(!t||!t.contains(e)){n=e;do{if(n.scrollHeight>n.offsetHeight){t=n,e.fastClickScrollParent=n;break}n=n.parentElement}while(n)}t&&(t.fastClickLastScrollTop=t.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e},FastClick.prototype.onTouchStart=function(e){var t,n,r;if(e.targetTouches.length>1)return!0;t=this.getTargetElementFromEventTarget(e.target),n=e.targetTouches[0];if(deviceIsIOS){r=window.getSelection();if(r.rangeCount&&!r.isCollapsed)return!0;if(!deviceIsIOS4){if(n.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=n.pageX,this.touchStartY=n.pageY,e.timeStamp-this.lastClickTime<200&&e.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(e){var t=e.changedTouches[0],n=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>n||Math.abs(t.pageY-this.touchStartY)>n?!0:!1},FastClick.prototype.onTouchMove=function(e){if(!this.trackingClick)return!0;if(this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e))this.trackingClick=!1,this.targetElement=null;return!0},FastClick.prototype.findControl=function(e){return e.control!==undefined?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(e){var t,n,r,i,s,o=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<200)return this.cancelNextClick=!0,!0;this.cancelNextClick=!1,this.lastClickTime=e.timeStamp,n=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,deviceIsIOSWithBadTarget&&(s=e.changedTouches[0],o=document.elementFromPoint(s.pageX-window.pageXOffset,s.pageY-window.pageYOffset)||o,o.fastClickScrollParent=this.targetElement.fastClickScrollParent),r=o.tagName.toLowerCase();if(r==="label"){t=this.findControl(o);if(t){this.focus(o);if(deviceIsAndroid)return!1;o=t}}else if(this.needsFocus(o)){if(e.timeStamp-n>100||deviceIsIOS&&window.top!==window&&r==="input")return this.targetElement=null,!1;this.focus(o),this.sendClick(o,e);if(!deviceIsIOS4||r!=="select")this.targetElement=null,(!/\bneedsclick\b/).test(o.className)&&e.preventDefault();return!1}if(deviceIsIOS&&!deviceIsIOS4){i=o.fastClickScrollParent;if(i&&i.fastClickLastScrollTop!==i.scrollTop)return!0}return this.needsClick(o)||(e.preventDefault(),this.sendClick(o,e)),!1},FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(e){return this.targetElement?e.forwardedTouchEvent?!0:e.cancelable?!this.needsClick(this.targetElement)||this.cancelNextClick?(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1):!0:!0:!0},FastClick.prototype.onClick=function(e){var t;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):e.target.type==="submit"&&e.detail===0?!0:(t=this.onMouse(e),t||(this.targetElement=null),t)},FastClick.prototype.destroy=function(){var e=this.layer;deviceIsAndroid&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(e){var t,n;if(typeof window.ontouchstart=="undefined")return!0;n=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(n){if(!deviceIsAndroid)return!0;t=document.querySelector("meta[name=viewport]");if(t){if(t.content.indexOf("user-scalable=no")!==-1)return!0;if(n>31&&window.innerWidth<=window.screen.width)return!0}}return e.style.msTouchAction==="none"?!0:!1},FastClick.attach=function(e){return new FastClick(e)},typeof define!="undefined"&&define.amd?define("fastclick",[],function(){return FastClick}):typeof module!="undefined"&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick,require.config({baseUrl:Y.jsBaseUrl,paths:{"jquery.lazyload":"lib/jquery.lazyload-1.8.4-min","jquery.touchswap":"lib/jquery.touchswap-1.6.3-min","jquery.atwho":"modules/widget/textarea/jquery.atwho.min","jquery.caret":"modules/widget/textarea/jquery.caret.min",juicer:"lib/juicer-0.6.5",cookie:"modules/util/cookie",prober:"modules/util/prober",dialog:"modules/widget/dialog/dialog",loginBox:"modules/yinyuetai/loginbox",ajax:"modules/util/ajax",ajaxform:"modules/util/ajaxform",uri:"lib/uri",pushstream:"lib/pushstream",yytStatis:"modules/yinyuetai/yytStatis",store:"lib/store.min",alertify:"modules/widget/alertify",swfobject:"lib/swfobject-2.0-min",page:"modules/yinyuetai/page",drag:"modules/interaction/drag",scrollbar:"modules/widget/tinyscrollbar",pwdencrypt:"modules/yinyuetai/passwordencrypt",user:"modules/yinyuetai/user/user",impress:"modules/widget/impress",placeholder:"modules/widget/placeholder",fancard:"modules/yinyuetai/fan/fancard",smart:"modules/util/smart",fastclick:"lib/fastclick.1.0.0",h5mvplayer:"modules/yinyuetai/player/h5/h5-mvplayer",h5mvplayerout:"modules/yinyuetai/player/h5/h5-mvplayer-out",viewer:"modules/yinyuetai/viewer-jq.min",area:"modules/yinyuetai/area",loginRegister:"modules/yinyuetai/login-register/main",qrcode:"lib/qrcode/jquery.qrcode",utf:"lib/qrcode/utf"},shim:{juicer:{exports:"juicer"},uri:{exports:"Uri"},pushstream:{exports:"PushStream"},swfobject:{exports:"swfobject"},impress:{exports:"impress"},viewer:{deps:["jquery"],exports:"viewer"}}}),function(){function r(t,n){var r,i,s,o,u,a,f,l;s={},o=n?e:function(e){return e},u=t.split(/;\s/g);for(r=0,i=u.length;r<i;r++){l=u[r].match(/([^=]+)=/i);if(l instanceof Array)try{a=e(l[1]),f=o(u[r].substring(l[1].length+1))}catch(c){}else a=e(u[r]),f="";a&&(s[a]=f)}return s}function i(e){if(!e||!e.length)throw new TypeError("Cookie name must be a non-empty string")}var e,t,n={};e=decodeURIComponent,t=encodeURIComponent,n.get=function(e,t){var n,s,o;return i(e),t=t||{},o=t.raw||!1,s=t.converter||function(e){return e},n=r(document.cookie,!o),s(n[e])},n.set=function(e,n,r){var s,o,u,a,f;return i(e),r=r||{},s=r.expires,o=r.domain,u=r.path,r.raw||(n=t(String(n))),a=e+"="+n,f=s,typeof f=="number"&&(f=new Date,f.setDate(f.getDate()+s)),f instanceof Date&&(a+="; expires="+f.toUTCString()),o&&o.length&&(a+="; domain="+o),u&&u.length&&(a+="; path="+u),r.secure&&(a+="; secure"),document.cookie=a,a},n.remove=function(e,t){return t=t||{},t.expires=new Date(0),this.set(e,"",t)},Y.Cookie=n,Y.isLoadByPartner=function(){var e=!1;try{if(window.parent!=window.self)return!0}catch(t){}return e}(),window.$config=window.$config||{},require(["fastclick"],function(e){e.attach(document.body)})}(),define("common",function(){}),define("cookie",["require","exports","module"],function(e,t){function i(e,t){var r,i,s,o,u,a,f,l;s={},o=t?n:function(e){return e},u=e.split(/;\s/g);for(r=0,i=u.length;r<i;r++){l=u[r].match(/([^=]+)=/i);if(l instanceof Array)try{a=n(l[1]),f=o(u[r].substring(l[1].length+1))}catch(c){}else a=n(u[r]),f="";a&&(s[a]=f)}return s}function s(e){if(!e||!e.length)throw new TypeError("Cookie name must be a non-empty string")}var n,r;n=decodeURIComponent,r=encodeURIComponent,t.get=function(e,t){var n,r,o;return s(e),t=t||{},o=t.raw||!1,r=t.converter||function(e){return e},n=i(document.cookie,!o),r(n[e])},t.set=function(e,t,n){var i,o,u,a,f;return s(e),n=n||{},i=n.expires,o=n.domain,u=n.path,n.raw||(t=r(String(t))),a=e+"="+t,f=i,typeof f=="number"&&(f=new Date,f.setDate(f.getDate()+i)),f instanceof Date&&(a+="; expires="+f.toUTCString()),o&&o.length&&(a+="; domain="+o),u&&u.length&&(a+="; path="+u),n.secure&&(a+="; secure"),document.cookie=a,a},t.remove=function(e,t){return t=t||{},t.expires=new Date(0),this.set(e,"",t)}}),function(e){function n(e){return e&&(e=decodeURIComponent(e),e=e.replace(t.pluses," ")),e}function r(e){var n=t.uri_parser,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],i=n.exec(e||""),s={};return r.forEach(function(e,t){s[e]=i[t]||""}),s}function i(e){var n,r,i,s,o,u,a=[];if(typeof e=="undefined"||e===null||e==="")return a;e.indexOf("?")===0&&(e=e.substring(1)),r=e.toString().split(t.query_separator);for(n=0;n<r.length;n++)i=r[n],s=i.indexOf("="),s!==0&&(o=decodeURIComponent(i.substring(0,s)),u=decodeURIComponent(i.substring(s+1)),a.push(s===-1?[i,null]:[o,u]));return a}function s(e){this.uriParts=r(e),this.queryPairs=i(this.uriParts.query),this.hasAuthorityPrefixUserPref=null}var t={starts_with_slashes:/^\/+/,ends_with_slashes:/\/+$/,pluses:/\+/g,query_separator:/[&;]/,uri_parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var n=0,r=this.length;n<r;++n)e.call(t||this,this[n],n,this)}),["protocol","userInfo","host","port","path","anchor"].forEach(function(e){s.prototype[e]=function(t){return typeof t!="undefined"&&(this.uriParts[e]=t),this.uriParts[e]}}),s.prototype.hasAuthorityPrefix=function(e){return typeof e!="undefined"&&(this.hasAuthorityPrefixUserPref=e),this.hasAuthorityPrefixUserPref===null?this.uriParts.source.indexOf("//")!==-1:this.hasAuthorityPrefixUserPref},s.prototype.query=function(e){var t="",n,r;typeof e!="undefined"&&(this.queryPairs=i(e));for(n=0;n<this.queryPairs.length;n++)r=this.queryPairs[n],t.length>0&&(t+="&"),r[1]===null?t+=r[0]:(t+=r[0],t+="=",r[1]&&(t+=encodeURIComponent(r[1])));return t.length>0?"?"+t:t},s.prototype.getQueryParamValue=function(e){var t,n;for(n=0;n<this.queryPairs.length;n++){t=this.queryPairs[n];if(e===t[0])return t[1]}},s.prototype.getQueryParamValues=function(e){var t=[],n,r;for(n=0;n<this.queryPairs.length;n++)r=this.queryPairs[n],e===r[0]&&t.push(r[1]);return t},s.prototype.deleteQueryParam=function(e,t){var r=[],i,s,o,u;for(i=0;i<this.queryPairs.length;i++)s=this.queryPairs[i],o=n(s[0])===n(e),u=s[1]===t,(arguments.length===1&&!o||arguments.length===2&&(!o||!u))&&r.push(s);return this.queryPairs=r,this},s.prototype.addQueryParam=function(e,t,n){return arguments.length===3&&n!==-1?(n=Math.min(n,this.queryPairs.length),this.queryPairs.splice(n,0,[e,t])):arguments.length>0&&this.queryPairs.push([e,t]),this},s.prototype.replaceQueryParam=function(e,t,r){var i=-1,s,o;if(arguments.length===3){for(s=0;s<this.queryPairs.length;s++){o=this.queryPairs[s];if(n(o[0])===n(e)&&decodeURIComponent(o[1])===n(r)){i=s;break}}this.deleteQueryParam(e,r).addQueryParam(e,t,i)}else{for(s=0;s<this.queryPairs.length;s++){o=this.queryPairs[s];if(n(o[0])===n(e)){i=s;break}}this.deleteQueryParam(e),this.addQueryParam(e,t,i)}return this},["protocol","hasAuthorityPrefix","userInfo","host","port","path","query","anchor"].forEach(function(e){var t="set"+e.charAt(0).toUpperCase()+e.slice(1);s.prototype[t]=function(t){return this[e](t),this}}),s.prototype.scheme=function(){var e="";return this.protocol()?(e+=this.protocol(),this.protocol().indexOf(":")!==this.protocol().length-1&&(e+=":"),e+="//"):this.hasAuthorityPrefix()&&this.host()&&(e+="//"),e},s.prototype.origin=function(){var e=this.scheme();return e=="file://"?e+this.uriParts.authority:(this.userInfo()&&this.host()&&(e+=this.userInfo(),this.userInfo().indexOf("@")!==this.userInfo().length-1&&(e+="@")),this.host()&&(e+=this.host(),this.port()&&(e+=":"+this.port())),e)},s.prototype.addTrailingSlash=function(){var e=this.path()||"";return e.substr(-1)!=="/"&&this.path(e+"/"),this},s.prototype.toString=function(){var e,n=this.origin();return this.path()?(e=this.path(),!t.ends_with_slashes.test(n)&&!t.starts_with_slashes.test(e)?n+="/":(n&&n.replace(t.ends_with_slashes,"/"),e=e.replace(t.starts_with_slashes,"/")),n+=e):this.host()&&(this.query().toString()||this.anchor())&&(n+="/"),this.query().toString()&&(this.query().toString().indexOf("?")!==0&&(n+="?"),n+=this.query().toString()),this.anchor()&&(this.anchor().indexOf("#")!==0&&(n+="#"),n+=this.anchor()),n},s.prototype.clone=function(){return new s(this.toString())},typeof define=="function"&&define.amd?define("uri",[],function(){return s}):typeof module!="undefined"&&typeof module.exports!="undefined"?module.exports=s:e.Uri=s}(this),define("modules/yinyuetai/secret",["require","exports","module","cookie"],function(e,t,n){function o(e){return g(a(m(e),e.length*8))}function u(e){var t=o(e);return t=t.substring(8,24),y(t)}function a(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;var n=1732584193,r=-271733879,i=-1732584194,s=271733878;for(var o=0;o<e.length;o+=16){var u=n,a=r,f=i,v=s;n=l(n,r,i,s,e[o+0],7,-680876936),s=l(s,n,r,i,e[o+1],12,-389564586),i=l(i,s,n,r,e[o+2],17,606105819),r=l(r,i,s,n,e[o+3],22,-1044525330),n=l(n,r,i,s,e[o+4],7,-176418897),s=l(s,n,r,i,e[o+5],12,1200080426),i=l(i,s,n,r,e[o+6],17,-1473231341),r=l(r,i,s,n,e[o+7],22,-45705983),n=l(n,r,i,s,e[o+8],7,1770035416),s=l(s,n,r,i,e[o+9],12,-1958414417),i=l(i,s,n,r,e[o+10],17,-42063),r=l(r,i,s,n,e[o+11],22,-1990404162),n=l(n,r,i,s,e[o+12],7,1804603682),s=l(s,n,r,i,e[o+13],12,-40341101),i=l(i,s,n,r,e[o+14],17,-1502002290),r=l(r,i,s,n,e[o+15],22,1236535329),n=c(n,r,i,s,e[o+1],5,-165796510),s=c(s,n,r,i,e[o+6],9,-1069501632),i=c(i,s,n,r,e[o+11],14,643717713),r=c(r,i,s,n,e[o+0],20,-373897302),n=c(n,r,i,s,e[o+5],5,-701558691),s=c(s,n,r,i,e[o+10],9,38016083),i=c(i,s,n,r,e[o+15],14,-660478335),r=c(r,i,s,n,e[o+4],20,-405537848),n=c(n,r,i,s,e[o+9],5,568446438),s=c(s,n,r,i,e[o+14],9,-1019803690),i=c(i,s,n,r,e[o+3],14,-187363961),r=c(r,i,s,n,e[o+8],20,1163531501),n=c(n,r,i,s,e[o+13],5,-1444681467),s=c(s,n,r,i,e[o+2],9,-51403784),i=c(i,s,n,r,e[o+7],14,1735328473),r=c(r,i,s,n,e[o+12],20,-1926607734),n=h(n,r,i,s,e[o+5],4,-378558),s=h(s,n,r,i,e[o+8],11,-2022574463),i=h(i,s,n,r,e[o+11],16,1839030562),r=h(r,i,s,n,e[o+14],23,-35309556),n=h(n,r,i,s,e[o+1],4,-1530992060),s=h(s,n,r,i,e[o+4],11,1272893353),i=h(i,s,n,r,e[o+7],16,-155497632),r=h(r,i,s,n,e[o+10],23,-1094730640),n=h(n,r,i,s,e[o+13],4,681279174),s=h(s,n,r,i,e[o+0],11,-358537222),i=h(i,s,n,r,e[o+3],16,-722521979),r=h(r,i,s,n,e[o+6],23,76029189),n=h(n,r,i,s,e[o+9],4,-640364487),s=h(s,n,r,i,e[o+12],11,-421815835),i=h(i,s,n,r,e[o+15],16,530742520),r=h(r,i,s,n,e[o+2],23,-995338651),n=p(n,r,i,s,e[o+0],6,-198630844),s=p(s,n,r,i,e[o+7],10,1126891415),i=p(i,s,n,r,e[o+14],15,-1416354905),r=p(r,i,s,n,e[o+5],21,-57434055),n=p(n,r,i,s,e[o+12],6,1700485571),s=p(s,n,r,i,e[o+3],10,-1894986606),i=p(i,s,n,r,e[o+10],15,-1051523),r=p(r,i,s,n,e[o+1],21,-2054922799),n=p(n,r,i,s,e[o+8],6,1873313359),s=p(s,n,r,i,e[o+15],10,-30611744),i=p(i,s,n,r,e[o+6],15,-1560198380),r=p(r,i,s,n,e[o+13],21,1309151649),n=p(n,r,i,s,e[o+4],6,-145523070),s=p(s,n,r,i,e[o+11],10,-1120210379),i=p(i,s,n,r,e[o+2],15,718787259),r=p(r,i,s,n,e[o+9],21,-343485551),n=d(n,u),r=d(r,a),i=d(i,f),s=d(s,v)}return Array(n,r,i,s)}function f(e,t,n,r,i,s){return d(v(d(d(t,e),d(r,s)),i),n)}function l(e,t,n,r,i,s,o){return f(t&n|~t&r,e,t,i,s,o)}function c(e,t,n,r,i,s,o){return f(t&r|n&~r,e,t,i,s,o)}function h(e,t,n,r,i,s,o){return f(t^n^r,e,t,i,s,o)}function p(e,t,n,r,i,s,o){return f(n^(t|~r),e,t,i,s,o)}function d(e,t){var n=(e&65535)+(t&65535),r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535}function v(e,t){return e<<t|e>>>32-t}function m(e){var t=Array(),n=(1<<r)-1;for(var i=0;i<e.length*r;i+=r)t[i>>5]|=(e.charCodeAt(i/r)&n)<<i%32;return t}function g(e){var t="0123456789abcdef",n="";for(var r=0;r<e.length*4;r++)n+=t.charAt(e[r>>2]>>r%4*8+4&15)+t.charAt(e[r>>2]>>r%4*8&15);return n}function y(e){var t="";for(var n=e.length-1;n>=0;n--)t+=e.charAt(n);return t}function b(e,t){return t.length!=13?(alert("timesign error !!!"),""):o(o(e)+t.substring(5,11))}function w(e,t){return t.length!=13?(alert("timesign error !!!"),""):o(u(e)+t.substring(5,11))}var r,i,s;r=8,s=e("cookie"),t.des=function(e){var t,n,r,i;return t=""+(new Date).getTime(),n=y(t),e&&e.length!=0?(r=b(e,t),i=w(e,n)):(r=b(t,n),i=w(n,t)),s.set("p2",i,{domain:"yinyuetai.com",path:"/"}),{_t:t,_p1:r,_p2:i}}}),define("ajaxform",["require","uri","modules/yinyuetai/secret"],function(e){function i(){var e,t;e=this.$el,t=this.options,e.submit(function(n){n.preventDefault(),o(e,r[t.secretName].apply(window,t.secretParam())),t.onRequest.call(e)&&(console.log(e.serialize()),$.ajax({type:"POST",url:e.attr("action"),data:e.serialize(),success:function(n){t.onComplete.call(e,n)}}))})}function s(e){function l(e){e.preventDefault();if(n.onRequest.call(t)){if(f)return!1;f=!0,t.off("submit"),o(t,r[u].apply(window,a())),t.submit(),t.on("submit",l)}}var t,n,i,s,u,a,f;return t=this.$el,n=this.options,u=n.secretName,a=n.secretParam,$("<input />").attr({type:"hidden",name:"cross_post",value:"1"}).appendTo(t),i=$("<iframe name="+e+"/>").attr({id:e,src:"about:blank"}).css("display","none").appendTo(document.body),i.on("load",function(){var t;try{t=$("#"+e)[0].contentWindow.document.body}catch(r){n.onError.call("上传错误")}f=!1;try{var t=$("#"+e)[0].contentWindow.document.body;s=t.innerText,s||(s=t.innerHTML),s&&n.onComplete.call(null,$.parseJSON(s))}catch(r){n.onComplete.call(null)}}),t.on("submit",l),i}function o(e,t){$.each(t,function(t,n){var r=e.find("[name="+t+"]");r.length===0?$("<input />").attr({type:"hidden",name:t,value:n}).appendTo(e):r.val(n)})}function u(e,n){return n=n||{},n.el=e,new t(n)}var t,n,r;return n=e("uri"),r=e("modules/yinyuetai/secret"),t=Backbone.View.extend({options:{secretName:"des",secretParam:function(){return[]},onRequest:function(){return!0},onComplete:function(e){},onError:function(e){}},initialize:function(e){var t,r;t=this.$el;if(t.attr("target")&&$(t.attr("target")).length!=0)return;(new n(t.attr("action"))).host()!==""||t.find("[type=file]").length!==0?(r="f"+(new Date).getTime(),t.attr("target",r),this.iframe=s.call(this,r)):i.call(this)}}),u}),define("ajax",["require","exports","module","uri","modules/yinyuetai/secret","ajaxform"],function(e,t,n){var r=e("uri"),i=e("modules/yinyuetai/secret"),s=[],o=function(e,t){return typeof e=="string"&&typeof t=="string"?e===t:typeof e=="object"&&typeof t=="object"?$.param(e)===$.param(t):!1},u=function(e){var t=(new r(e)).host();return t!==""&&t!==document.domain},a=function(e){var t=$('<form method="post"></form>').attr({action:e.url}).appendTo(document.body),n=e.data||"",r,i={};return typeof n=="string"?(r=n.split("&"),$.each(r,function(e,t){t=t.split("="),i[t[0]]=t[1]})):i=n,$.each(i,function(e,n){$('<input type="hidden"/>').attr({name:e,value:n}).appendTo(t)}),t},f=function(t){var n=e("ajaxform"),r=a(t);new n(r,{secretParam:t.secretParam||function(){return[]},onComplete:function(e){$(r.attr("target")).remove(),r.remove(),t.success&&t.success(e),_.isFunction(t.complete)?t.complete(e):_.isArray(t.complete)&&_.each(t.complete,function(t){t(e)})}}),r.submit()},l=function(e){for(var t=0,n=s.length;t<n;t++){var r=s[t];if(e.url==r.url&&o(r.data,e.data))return!1}s.push(e);var i=e.type.toLowerCase();if(u(e.url)){if(i==="post")return f(e),!1;e.dataType="jsonp"}else if(i==="post"){var a=c(e.secretName,e.secretParam);a&&(e.data?typeof e.data=="string"?e.data+="&"+$.param(a):e.data=$.extend(e.data,a):e.data=a)}return e},c=function(e,t){return i[e]?i[e](t()):null};return{ajax:function(e){var t=[function(){s=_.without(s,e)}];e.complete&&(t=t.concat(e.complete)),e.complete=undefined,e=$.extend({timeout:1e4,jsonp:"callback",type:"get",secretName:"des",secretParam:function(){return[]},complete:t},e);var n=!0;e.beforeSend&&typeof e.beforeSend=="function"&&(n=e.beforeSend());if(n===!1)return;var r=l(e);if(r)return $.ajax(r)},get:function(e,t,n,r){var i={type:"GET"};return e&&(i.url=e),t&&(i.data=t),n&&(i.success=n),r&&(i.dataType=r),this.ajax(i)},getJSON:function(e,t,n){return this.get(e,t,n,"json")},post:function(e,t,n,r){var i={type:"POST"};return e&&(i.url=e),t&&(i.data=t),n&&(i.success=n),r&&(i.dataType=r),this.ajax(i)}}}),define("user",["require","exports","module","cookie","ajax"],function(e,t,n){function u(e){var t,n;t=String.fromCharCode(2),e=decodeURIComponent(e),n=e.split(t),n.length>=7?l.set({userId:n[0]*1,userName:n[1],vipLevel:n[5],rewardImg:n[6]}):l.set({userId:n[0]*1,userName:n[1]})}function a(e){o.getJSON(Y.domains.loginSite+"/login-info","",function(t){l.set(t),e&&e()})}function f(e,t){$.ajax({url:r,type:"get",dataType:"jsonp",jsonp:"callback",success:function(n){if(n&&!n.error)if(n.realVip&&parseInt(n.realVip)>0||n.isWo){l.set("vipInfo",n),e(n);return}t()},error:function(){t()}})}var r="//vip.yinyuetai.com/vip/check-vip",i,s,o;i=e("cookie"),o=e("ajax"),e(["modules/yinyuetai/login-register/main"]),s=Backbone.Model.extend({defaults:{userName:"",userId:0,vipLevel:0,rewardImg:""},isLogined:function(){return parseInt(this.get("userId"))?!0:!1},onLogin:function(e){this.on("logined",e)},logined:function(e){this.isLogined()?e():this.on("logined",e)},register:function(t,n){var r=this;this.isLogined()?t():(this.on("login",t),e(["modules/yinyuetai/login-register/login-register-box"],function(e){e.show("register"),e.observer.one("manualCloseLoginRegisterDialog",function(){r.off("login"),n&&n()})}))},login:function(t,n){var r=this;this.isLogined()?t():(this.on("login",t),e(["modules/yinyuetai/login-register/login-register-box"],function(e){e.show("login"),e.observer.one("manualCloseLoginRegisterDialog",function(){r.off("login"),n&&n()})}))},emit:function(){function r(){var e=document.cookie.match(/[^ =;]+(?=\=)/g);if(e)for(var t=e.length;t--;)document.cookie=e[t]+"=0;expires="+(new Date(0)).toUTCString()}var e,t,n;e=i.get("token"),t=i.get("u_inf"),n=i.get("withmobile"),typeof n!="undefined"?this.setWithmobile(n):e!=null&&(t!=null&&t.length>0?u(t,n):a())},setWithmobile:function(e){this.set({withmobile:e}),o.getJSON("//login.yinyuetai.com/logout")},unsetWithmobile:function(){this.unset("withmobile")},getUserInfo:function(e,t){if(this.isLogined()){var n=this;typeof e=="function"&&(t=e);var r=function(){return typeof e=="function"?n.toJSON():n.get(e)};n.has("isEmailVerified")?t&&t(r()):a(function(){t&&t(r())})}},checkEmail:function(t){this.getUserInfo("isEmailVerified",function(n){if(!n){var r='<div style="padding: 20px 30px;"><p>您好像还没有进行邮箱验证。</p><p>为不影响部分功能的使用，请先进行 <a href="'+Y.domains.homeSite+'/settings/bind" target="_blank" class="special f14">邮箱验证</a></p>'+"</div>";e(["dialog"],function(e){new e(r,{title:"邮箱验证",width:400,height:100,isAutoShow:!0})})}else t&&t()})},checkVIP:function(e,t){if(!this.isLogined())this.login(function(){f(e,t)},t);else if(l.get("vipInfo")){var n=l.get("vipInfo");n&&!n.error&&n.realVip&&parseInt(n.realVip)>0?e(n):t()}else f(e,t)},isVipUser:function(){var e=i.get("token");if(e){var t=e.split("."),n;if(t.length>2)return n=t[2],parseInt(n[0])>0}return!1},getToken:function(){return i.get("token")}});var l=new s;return l.on("change:userId",function(){l.trigger("logined"),l.trigger("login")}),l.emit(),l}),define("modules/widget/dialog/mask",["require"],function(e){var t,n,r,i;return r=$(document),i=navigator.userAgent.indexOf("MSIE 6.0")!==-1,n={position:i?"absolute":"fixed",top:0,left:0,width:"100%",height:i?r.outerHeight(!0):"100%",display:"none","z-index":998,opacity:.2,"background-color":"black"},t=Backbone.View.extend({initialize:function(){this.element=$("<iframe/>").attr({frameborder:0,scrolling:"no"}).css(n).appendTo(document.body)},show:function(){this.element.fadeIn()},hide:function(){this.element.fadeOut()}}),new t}),define("dialog",["require","exports","module","modules/widget/dialog/mask"],function(e,t,n){function u(e,t){return t=t||{},t.el=e||"<b></b>",new r(t)}var r,i,s,o;return i=e("modules/widget/dialog/mask"),s='<a href="javascript:void(0);" class="ico_close J_close">关闭</a>',o='<h3 class="dialog_title J_title">{title}</h3>',r=Backbone.View.extend({options:{width:"",height:"",hasMark:!0,hasClose:!0,isRemoveAfterHide:!0,isAutoShow:!0,title:"",className:"",effect:"fade",draggable:!0,onShow:function(){},onHide:function(){}},events:{"click .J_close":"_close"},initialize:function(){this._status=!1,this.$el=$('<div class="dialog"/>').append(this.$el.show()).addClass(this.options.className).appendTo(document.body),this._isShowTitle(),this._isShowClose(),this._adjustPosition(),this.on("show",function(){this._status=!0,this._toggle("show")}),this.on("hide",function(){this._status=!1,this._toggle("hide")}),this.on("show",this.options.onShow,this.$el),this.on("hide",this.options.onHide,this.$el),this.options.isAutoShow&&this.trigger("show"),this._setDraggable()},_getStyle:function(e){var t,n;t=this.options.width,n=this.options.height,n&&this.options.title!=""&&(n+=30);var e={width:t,height:n,"margin-left":-(t/2),"margin-top":-(n/2)};return e},_isShowTitle:function(){var e=this.options.title;e!=""&&(this.$title=$(o.replace("{title}",e)).prependTo(this.$el))},_isShowClose:function(){this.options.hasClose&&$(s).attr("hidefocus","true").appendTo(this.$el)},_close:function(){this.trigger("hide")},_toggle:function(e){var t,n;t=this.options.effect,n=this,e=="show"?t==="none"?this.$el.css("display","block"):t==="fade"&&this.$el.fadeIn():e=="hide"&&(t==="none"?this.$el.css("display","none"):t==="fade"&&this.$el.fadeOut(),this.options.isRemoveAfterHide&&setTimeout(function(){n.$el.remove()},2e3)),this._toggleMask(e)},_toggleMask:function(e){this.options.hasMark&&(e=="show"?i.show():e=="hide"&&i.hide())},_adjustPosition:function(){var e={width:this.options.width||this.$el.innerWidth(),height:this.options.height?this.options.title!=""?this.options.height+30:this.options.height:this.$el.innerHeight()};this.$el.css(_.extend({marginLeft:-(e.width/2),marginTop:-(e.height/2)},e))},_setDraggable:function(){var t=this,n=this.options.draggable,r=this.options.title;n&&e(["modules/widget/jquery-draggable-min"],function(){var e={containment:i.element||"body",scroll:!1},n;r&&(n="h3.J_title",e.handle=n,$(n).css("cursor","move")),t.$el.draggable(e)})},status:function(){return this._status?"show":"hide"},show:function(){return this.trigger("show"),this},hide:function(){return this.trigger("hide"),this},destroy:function(){this.$el.remove(),i.hide()},resize:function(e,t){return this.options.width=e,this.options.height=t,this._adjustPosition(),this},title:function(e){return this.$title&&this.$title.html(e),this}}),u}),define("pwdencrypt",[],function(){function e(e){var t=0,n=1,r="inputvec",i=1,s="yytcdn2b",o=new Array(16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756),u=new Array(-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344),a=new Array(520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584),f=new Array(8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928),l=new Array(256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080),c=new Array(536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312),h=new Array(2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154),p=new Array(268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696);pc2bytes0=new Array(0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964),pc2bytes1=new Array(0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697),pc2bytes2=new Array(0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272),pc2bytes3=new Array(0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144),pc2bytes4=new Array(0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256),pc2bytes5=new Array(0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488),pc2bytes6=new Array(0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746),pc2bytes7=new Array(0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568),pc2bytes8=new Array(0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578),pc2bytes9=new Array(0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488),pc2bytes10=new Array(0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800),pc2bytes11=new Array(0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744),pc2bytes12=new Array(0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128),pc2bytes13=new Array(0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261);var d=s.length>8?3:1,v=new Array(32*d),m=new Array(0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0),g,y,b=0,w=0,E;for(var S=0;S<d;S++){k=s.charCodeAt(b++)<<24|s.charCodeAt(b++)<<16|s.charCodeAt(b++)<<8|s.charCodeAt(b++),L=s.charCodeAt(b++)<<24|s.charCodeAt(b++)<<16|s.charCodeAt(b++)<<8|s.charCodeAt(b++),E=(k>>>4^L)&252645135,L^=E,k^=E<<4,E=(L>>>-16^k)&65535,k^=E,L^=E<<-16,E=(k>>>2^L)&858993459,L^=E,k^=E<<2,E=(L>>>-16^k)&65535,k^=E,L^=E<<-16,E=(k>>>1^L)&1431655765,L^=E,k^=E<<1,E=(L>>>8^k)&16711935,k^=E,L^=E<<8,E=(k>>>1^L)&1431655765,L^=E,k^=E<<1,E=k<<8|L>>>20&240,k=L<<24|L<<8&16711680|L>>>8&65280|L>>>24&240,L=E;for(var x=0;x<m.length;x++)m[x]?(k=k<<2|k>>>26,L=L<<2|L>>>26):(k=k<<1|k>>>27,L=L<<1|L>>>27),k&=-15,L&=-15,g=pc2bytes0[k>>>28]|pc2bytes1[k>>>24&15]|pc2bytes2[k>>>20&15]|pc2bytes3[k>>>16&15]|pc2bytes4[k>>>12&15]|pc2bytes5[k>>>8&15]|pc2bytes6[k>>>4&15],y=pc2bytes7[L>>>28]|pc2bytes8[L>>>24&15]|pc2bytes9[L>>>20&15]|pc2bytes10[L>>>16&15]|pc2bytes11[L>>>12&15]|pc2bytes12[L>>>8&15]|pc2bytes13[L>>>4&15],E=(y>>>16^g)&65535,v[w++]=g^E,v[w++]=y^E<<16}var b=0,x,S,E,T,N,C,k,L,A,O,M,_,D,P,H,B=e.length,j=0,d=v.length==32?3:9;d==3?A=n?new Array(0,32,2):new Array(30,-2,-2):A=n?new Array(0,32,2,62,30,-2,64,96,2):new Array(94,62,-2,32,64,2,30,-2,-2),E=8-B%8,e+=String.fromCharCode(E,E,E,E,E,E,E,E),E==8&&(B+=8),result="",tempresult="";while(b<B){k=e.charCodeAt(b++)<<24|e.charCodeAt(b++)<<16|e.charCodeAt(b++)<<8|e.charCodeAt(b++),L=e.charCodeAt(b++)<<24|e.charCodeAt(b++)<<16|e.charCodeAt(b++)<<8|e.charCodeAt(b++),E=(k>>>4^L)&252645135,L^=E,k^=E<<4,E=(k>>>16^L)&65535,L^=E,k^=E<<16,E=(L>>>2^k)&858993459,k^=E,L^=E<<2,E=(L>>>8^k)&16711935,k^=E,L^=E<<8,E=(k>>>1^L)&1431655765,L^=E,k^=E<<1,k=k<<1|k>>>31,L=L<<1|L>>>31;for(S=0;S<d;S+=3){P=A[S+1],H=A[S+2];for(x=A[S];x!=P;x+=H)N=L^v[x],C=(L>>>4|L<<28)^v[x+1],E=k,k=L,L=E^(u[N>>>24&63]|f[N>>>16&63]|c[N>>>8&63]|p[N&63]|o[C>>>24&63]|a[C>>>16&63]|l[C>>>8&63]|h[C&63]);E=k,k=L,L=E}k=k>>>1|k<<31,L=L>>>1|L<<31,E=(k>>>1^L)&1431655765,L^=E,k^=E<<1,E=(L>>>8^k)&16711935,k^=E,L^=E<<8,E=(L>>>2^k)&858993459,k^=E,L^=E<<2,E=(k>>>16^L)&65535,L^=E,k^=E<<16,E=(k>>>4^L)&252645135,L^=E,k^=E<<4,tempresult+=String.fromCharCode(k>>>24,k>>>16&255,k>>>8&255,k&255,L>>>24,L>>>16&255,L>>>8&255,L&255),j+=8,j==512&&(result+=tempresult,tempresult="",j=0)}var F=result+tempresult,I="",q=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");for(var x=0;x<F.length;x++)I+=q[F.charCodeAt(x)>>4]+q[F.charCodeAt(x)&15];return I}return e}),define("loginBox",["require","exports","module","dialog","ajaxform","user","pwdencrypt"],function(e,t,n){function p(){h.refresh(),c=!1}function d(e){var t,n,r;t=e.find(".errorinfo"),n=e.find("[name=email]"),r=e.find(".pwd"),m(n),m(r),new s(e,{secretParam:function(){return[$.trim(n.val())+$.trim(r.val())]},onRequest:function(){if(!v(n,r,t))return!1;if(!c){var i="拖动滑块完成验证";return t.text(i).css("visibility","visible"),!1}return e.find("[name=encpsw]").length!=0?e.find("[name=encpsw]").val(a(r.val())):$("<input />").attr({type:"hidden",name:"encpsw",value:a(r.val())}).appendTo(e),!0},onComplete:function(e){e.error?(t.text(e.message).css("visibility","visible"),p()):e.platFormRef?location.href="//login.yinyuetai.com/platform":(u.set(e),o.trigger("hide"))}})}function v(e,t,n){var r,i;r=$.trim(e.val()),i=$.trim(t.val());if(r.length===0)return n.text("邮箱或手机不能为空").css("visibility","visible"),e.parent().addClass("emailerror"),!1;if(!f.test(r)){if(!l.test(r))return n.text("请输入正确的电子邮箱或手机").css("visibility","visible"),e.parent().addClass("emailerror"),!1;if(r.length!==11)return n.text("请输入正确的电子邮箱或手机").css("visibility","visible"),e.parent().addClass("emailerror"),!1}return i.length===0?(n.text("密码不能为空").css("visibility","visible"),t.parent().addClass("error"),!1):i.length<4||i.length>20?(n.text("密码长度必须大于4且小于20").css("visibility","visible"),t.parent().addClass("error"),!1):!0}function m(e){e.attr("name")==="email"?(e.focus(function(){$(this).parent().addClass("emailfocus").removeClass("emailerror")}),e.blur(function(){$(this).parent().removeClass("emailfocus")})):(e.focus(function(){$(this).parent().addClass("focus").removeClass("error")}),e.blur(function(){$(this).parent().removeClass("focus")}))}var r,i,s,o,u,a,f=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,l=/^[+-]?[1-9][0-9]*(\.[0-9]+)?([eE][+-][1-9][0-9]*)?$|^[+-]?0?\.[0-9]+([eE][+-][1-9][0-9]*)?$/;r=e("dialog"),s=e("ajaxform"),u=e("user"),a=e("pwdencrypt"),i=['<div class="loginbox">','<div class="external">','<p class="title">使用合作账号登录<span>(推荐)</span></p>',"<ul>","<li>",'<a href="<%=url%>/api/login/sina-auth" target="_blank" class="weibo" hidefocus>微博帐号</a>',"</li>","<li>",'<a href="<%=url%>/api/login/wechat-auth" target="_blank" class="wechat" hidefocus>微信账号</a>',"</li>","<li>",'<a href="<%=url%>/api/login/qq-auth" target="_blank" class="qq" hidefocus>QQ帐号</a>',"</li>","<li>",'<a href="<%=url%>/api/login/renren-auth" target="_blank" class="renren" hidefocus>人人账号</a>',"</li>","<li>",'<a href="<%=url%>/api/login/baidu-auth" target="_blank" class="baidu" hidefocus>百度帐号</a>',"</li>","</ul>",'<div class="loginbox-placehold">',"</div>",'<p class="text">快捷登录，无需注册</p>','<p class="text">与你的朋友分享你的爱！</p>',"</div>",'<div class="site">','<p class="title">音悦Tai账号登录</p>','<form id="loginBoxForm" action="//login.yinyuetai.com/login-ajax" method="post">','<p class="errorinfo">错误信息提示</p>','<div class="email focuss">','<input type="text" name="email" placeholder="您的邮箱地址或绑定手机"/>',"</div>",'<div class="password">','<input type="password" class="pwd" placeholder="请输入密码"/>',"</div>",'<div id="captcha">',"</div>","<div>",'<p class="autologin"><input type="checkbox" id="autocheckbox" name="autologin" checked hidefocus/><label for="autocheckbox">下次自动登录</label></p>','<a class="forgot" href="<%=url%>/forgot-password" target="_blank" hidefocus>忘记密码</a>',"</div>","<div>",'<input class="submit" type="submit" hidefocus/>','<p class="reg">还没有音悦Tai账号？<a href="<%=url%>/register" target="_blank" hidefocus>立即注册！</a></p>',"</div>","</form>","</div>","</div>"].join(""),o=new r(_.template(i,{url:"//login.yinyuetai.com"}),{width:691,height:342,isRemoveAfterHide:!1,isAutoShow:!1,draggable:!1});var c=!1,h;return window.gt_custom_ajax=function(e,t){if(e){c=!0;var n=o.$el.find("form").find(".errorinfo");n.html()=="拖动滑块完成验证"&&n.css("visibility","hidden")}},o.on("show",function(){h||(h=new window.Geetest({gt:"cc34bd7df5c42f7d9c3f540fdfb671cf",product:"float"}),h.appendTo("#captcha")),d(o.$el.find("form")),UA_Opt.reload(),$.getJSON("//www.yinyuetai.com/partner/get-partner-code?placeIds=reg_window&callback=?",function(e){e&&e.reg_window&&o.$el.find(".loginbox-placehold").html(e.reg_window)})}),o.on("hide",function(){var e=o.$el.find("form");e.find(".errorinfo").css("visibility","hidden"),e.find("[name=email],[name=password]").parent().removeClass("emailerror").removeClass("error"),$(".J_pop_download").removeClass("v_button_curv"),setTimeout(function(){p()},500)}),o}),define("prober",["require","exports","module"],function(e,t){function c(e,t,n){var r,i;for(r=0,i=e.length;r<i;r++)if(t.call(e,e[r],r)===!1)break}function h(e){var t,n,r,i,o,u,a,f;return s.test(e)?(u=!1,e.indexOf("trident/")!==-1&&(t=/\btrident\/([0-9.]+)/.exec(e),t&&t.length>=2&&(r=t[1],f=t[1].split("."),f[0]=parseInt(f[0],10)+4,o=f.join("."))),t=s.exec(e),i=t[1],a=t[1].split("."),"undefined"==typeof o&&(o=i),a[0]=parseInt(a[0],10)-4,n=a.join("."),"undefined"==typeof r&&(r=n),{browserVersion:o,browserMode:i,engineVersion:r,engineMode:n,compatible:r!==n}):null}function p(e,t,n){var i,s,u,a;typeof n=="undefined"&&(n=r),i=o.call(t)==="[object Function]"?t.call(null,n):t;if(!i)return null;s={name:e,version:"-1",codename:""},u=o.call(i);if(i===!0)return s;if(u==="[object String]"){if(n.indexOf(i)!==-1)return s}else{if(o.call(i)==="[object Object]")return i.hasOwnProperty("version")&&(s.version=i.version),s;if(i.exec){a=i.exec(n);if(a)return a.length>=2&&a[1]?s.version=a[1].replace(/_/g,"."):s.version="-1",s}}}function d(e,t,n){var r;r={name:"na",version:"-1"},c(t,function(t){var n;n=p(t[0],t[1],e);if(n)return r=n,!1}),n(r.name,r.version)}function v(e){var t,n;return t={},e=(e||"").toLowerCase(),d(e,u,function(e,n){var r;r=parseFloat(n),t.device={name:e,version:r,fullVersion:n},t.device[e]=r}),d(e,a,function(e,n){var r;r=parseFloat(n),t.os={name:e,version:r,fullVersion:n},t.os[e]=r}),n=h(e),d(e,f,function(e,r){var i,s;i=r,n&&(r=n.engineVersion||n.engineMode,i=n.engineMode),s=parseFloat(r),t.engine={name:e,version:s,fullVersion:r,mode:parseFloat(i),fullMode:i,compatible:n?n.compatible:!1},t.engine[e]=s}),d(e,l,function(e,r){var i,s;i=r,n&&(e==="ie"&&(r=n.browserVersion),i=n.browserMode),s=parseFloat(r),t.browser={name:e,version:s,fullVersion:r,mode:parseFloat(i),fullMode:i,compatible:n?n.compatible:!1},t.browser[e]=s}),t}var n,r,i,s,o,u,a,f,l;return n={},r=navigator.userAgent||"",i=window.external,s=/\b(?:msie|ie) ([0-9.]+)/,o=Object.prototype.toString,u=[["nokia",function(e){return e.indexOf("nokia ")!==-1?/\bnokia ([0-9]+)?/:/\bnokia[\d]/.test(e)?/\bnokia(\d+)/:"nokia"}],["wp",function(e){return e.indexOf("windows phone ")!==-1||e.indexOf("xblwp")!==-1||e.indexOf("zunewp")!==-1||e.indexOf("windows ce")!==-1}],["mi",function(e){return e.indexOf("mi-one plus")!==-1?{version:"1s"}:/\bmi ([0-9.as]+)/}],["playstation",function(e){return(e.indexOf("playstation")!==-1||e.indexOf("wii")!==-1)&&e.indexOf("windows")==-1}],["blackberry",function(e){return(e.indexOf("blackberry")!==-1||e.indexOf("playbook ")!==-1||e.indexOf("rim")!==-1||e.indexOf("tablet")!==-1||e.indexOf("bb10")!==-1)&&e.indexOf("windows")==-1}],["pc","windows"],["ipad","ipad"],["ipod","ipod"],["iphone","iphone"],["mac","macintosh"],["aliyun","aliyunos"],["meizu",/\bm([0-9]+)\b/],["nexus",/\bnexus ([0-9.]+)/],["android","android"]],a=[["wp",function(e){return e.indexOf("windows phone ")!==-1?/\bwindows phone (?:os )?([0-9.]+)/:e.indexOf("xblwp")!==-1?/\bxblwp([0-9.]+)/:e.indexOf("zunewp")!==-1?/\bzunewp([0-9.]+)/:"windows phone"}],["windows",/\bwindows nt ([0-9.]+)/],["macosx",/\bmac os x ([0-9._]+)/],["ios",/\bcpu(?: iphone)? os ([0-9._]+)/],["yunos",/\baliyunos ([0-9.]+)/],["android",/\bandroid[ -]([0-9.]+)/],["chromeos",/\bcros i686 ([0-9.]+)/],["linux","linux"],["windowsce",/\bwindows ce(?: ([0-9.]+))?/],["symbian",/\bsymbianos\/([0-9.]+)/],["blackberry","blackberry"]],f=[["trident",s],["webkit",/\bapplewebkit\/([0-9.+]+)/],["gecko",/\bgecko\/(\d+)/],["presto",/\bpresto\/([0-9.]+)/]],l=[["sg",/ se ([0-9.x]+)/],["mx",function(e){try{if(i&&(i.mxVersion||i.max_version))return{version:i.mxVersion||i.max_version}}catch(t){}return/\bmaxthon(?:[ \/]([0-9.]+))?/}],["qq",/\bqqbrowser\/([0-9.]+)/],["green","greenbrowser"],["tt",/\btencenttraveler ([0-9.]+)/],["lb",function(e){if(e.indexOf("lbbrowser")===-1)return!1;var t="-1";try{i&&i.LiebaoGetVersion&&(t=i.LiebaoGetVersion())}catch(n){}return{version:t}}],["tao",/\btaobrowser\/([0-9.]+)/],["fs",/\bcoolnovo\/([0-9.]+)/],["sy","saayaa"],["baidu",/\bbidubrowser[ \/]([0-9.x]+)/],["ie",s],["mi",/\bmiuibrowser\/([0-9.]+)/],["opera",function(e){var t=/\bopera.+version\/([0-9.ab]+)/,n=/\bopr\/([0-9.]+)/;return t.test(e)?t:n}],["chrome",/ (?:chrome|crios|crmo)\/([0-9.]+)/],["android",function(e){if(e.indexOf("android")===-1)return;return/\bversion\/([0-9.]+(?: beta)?)/}],["safari",/\bversion\/([0-9.]+(?: beta)?)(?: mobile(?:\/[a-z0-9]+)?)? safari\//],["firefox",/\bfirefox\/([0-9.ab]+)/],["uc",function(e){return e.indexOf("ucbrowser")!==-1?/\bucbrowser\/([0-9.]+)/:/\bucweb([0-9.]+)/}]],n=v(navigator.userAgent),n.parse=v,n}),define("placeholder",["require","exports","module"],function(e,t,n){var r,i;i=function(e){function a(t){var n={},r=/^jQuery\d+$/;return e.each(t.attributes,function(e,t){t.specified&&!r.test(t.name)&&(n[t.name]=t.value)}),n}function f(t,n){var r=this,i=e(r);if(r.value==i.attr("placeholder")&&i.hasClass("placeholder"))if(i.data("placeholder-password")){i=i.hide().next().show().attr("id",i.removeAttr("id").data("placeholder-id"));if(t===!0)return i[0].value=n;i.focus()}else r.value="",i.removeClass("placeholder"),r==document.activeElement&&r.select()}function l(){var t,n=this,r=e(n),i=this.id;if(n.value==""){if(n.type=="password"){if(!r.data("placeholder-textinput")){try{t=r.clone().attr({type:"text"})}catch(s){t=e("<input>").attr(e.extend(a(this),{type:"text"}))}t.removeAttr("name").data({"placeholder-password":r,"placeholder-id":i}).bind("focus.placeholder",f),r.data({"placeholder-textinput":t,"placeholder-id":i}).before(t)}r=r.removeAttr("id").hide().prev().attr("id",i).show()}r.addClass("placeholder"),r[0].value=r.attr("placeholder")}else r.removeClass("placeholder")}var t="placeholder"in document.createElement("input"),n="placeholder"in document.createElement("textarea"),r={},i=e.valHooks,s=e.propHooks,o,u;return t&&n?(u=r.placeholder=function(){return this},u.input=u.textarea=!0):(u=r.placeholder=function(){var e=this;return e.filter((t?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":f,"blur.placeholder":l}).data("placeholder-enabled",!0).trigger("blur.placeholder"),e},u.input=t,u.textarea=n,o={get:function(t){var n=e(t),r=n.data("placeholder-password");return r?r[0].value:n.data("placeholder-enabled")&&n.hasClass("placeholder")?"":t.value},set:function(t,n){var r=e(t),i=r.data("placeholder-password");return i?i[0].value=n:r.data("placeholder-enabled")?(n==""?(t.value=n,t!=document.activeElement&&l.call(t)):r.hasClass("placeholder")?f.call(t,!0,n)||(t.value=n):t.value=n,r):t.value=n}},t||(i.input=o,s.value=o),n||(i.textarea=o,s.value=o),e(function(){e(document).delegate("form","submit.placeholder",function(){var t=e(".placeholder",this).each(f);setTimeout(function(){t.each(l)},10)})}),e(window).bind("beforeunload.placeholder",function(){e(".placeholder").each(function(){this.value=""})})),u}($),r=!i.input||!i.textarea?function(e){e||(e=$("input, textarea")),e&&i.call($(e))}:function(){},r(),r.clear=function(e){function t(e){e.each(function(e,t){t=$(t),t[0].value===t.attr("placeholder")&&t.hasClass("placeholder")&&(t[0].value="")})}e=$(e),e[0].tagName==="FORM"?t(e.find("input.placeholder, textarea.placeholder")):t(e)},n.exports=r}),function(){var e=function(){var t=[].slice.call(arguments);t.push(e.options),t[0].match(/^\s*#([\w:\-\.]+)\s*$/igm)&&t[0].replace(/^\s*#([\w:\-\.]+)\s*$/igm,function(e,n){var r=document,i=r&&r.getElementById(n);t[0]=i?i.value||i.innerHTML:e});if(arguments.length==1)return e.compile.apply(e,t);if(arguments.length>=2)return e.to_html.apply(e,t)},t={escapehash:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},escapereplace:function(e){return t.escapehash[e]},escaping:function(e){return typeof e!="string"?e:e.replace(/[&<>"]/igm,this.escapereplace)},detection:function(e){return typeof e=="undefined"?"":e}},n=function(e){if(typeof console!="undefined"){if(console.warn){console.warn(e);return}if(console.log){console.log(e);return}}throw e},r=function(e,t){e=e!==Object(e)?{}:e;if(e.__proto__)return e.__proto__=t,e;var n=function(){},r=Object.create?Object.create(t):new(n.prototype=t,n);for(var i in e)e.hasOwnProperty(i)&&(r[i]=e[i]);return r};e.__cache={},e.version="0.6.5-stable",e.settings={},e.tags={operationOpen:"{@",operationClose:"}",interpolateOpen:"{{",interpolateClose:"}}",noneencodeOpen:"{{{",noneencodeClose:"}}}",commentOpen:"\\{#",commentClose:"\\}"},e.options={cache:!0,strip:!0,errorhandling:!0,detection:!0,_method:r({__escapehtml:t,__throw:n,__juicer:e},{})},e.tagInit=function(){var t=e.tags.operationOpen+"each\\s*([^}]*?)\\s*as\\s*(\\w*?)\\s*(,\\s*\\w*?)?"+e.tags.operationClose,n=e.tags.operationOpen+"\\/each"+e.tags.operationClose,r=e.tags.operationOpen+"if\\s*([^}]*?)"+e.tags.operationClose,i=e.tags.operationOpen+"\\/if"+e.tags.operationClose,s=e.tags.operationOpen+"else"+e.tags.operationClose,o=e.tags.operationOpen+"else if\\s*([^}]*?)"+e.tags.operationClose,u=e.tags.interpolateOpen+"([\\s\\S]+?)"+e.tags.interpolateClose,a=e.tags.noneencodeOpen+"([\\s\\S]+?)"+e.tags.noneencodeClose,f=e.tags.commentOpen+"[^}]*?"+e.tags.commentClose,l=e.tags.operationOpen+"each\\s*(\\w*?)\\s*in\\s*range\\(([^}]+?)\\s*,\\s*([^}]+?)\\)"+e.tags.operationClose,c=e.tags.operationOpen+"include\\s*([^}]*?)\\s*,\\s*([^}]*?)"+e.tags.operationClose;e.settings.forstart=new RegExp(t,"igm"),e.settings.forend=new RegExp(n,"igm"),e.settings.ifstart=new RegExp(r,"igm"),e.settings.ifend=new RegExp(i,"igm"),e.settings.elsestart=new RegExp(s,"igm"),e.settings.elseifstart=new RegExp(o,"igm"),e.settings.interpolate=new RegExp(u,"igm"),e.settings.noneencode=new RegExp(a,"igm"),e.settings.inlinecomment=new RegExp(f,"igm"),e.settings.rangestart=new RegExp(l,"igm"),e.settings.include=new RegExp(c,"igm")},e.tagInit(),e.set=function(e,t){var n=this,r=function(e){return e.replace(/[\$\(\)\[\]\+\^\{\}\?\*\|\.]/igm,function(e){return"\\"+e})},i=function(e,t){var i=e.match(/^tag::(.*)$/i);if(i){n.tags[i[1]]=r(t),n.tagInit();return}n.options[e]=t};if(arguments.length===2){i(e,t);return}if(e===Object(e))for(var s in e)e.hasOwnProperty(s)&&i(s,e[s])},e.register=function(e,t){var n=this.options._method;return n.hasOwnProperty(e)?!1:n[e]=t},e.unregister=function(e){var t=this.options._method;if(t.hasOwnProperty(e))return delete t[e]},e.template=function(t){var n=this;this.options=t,this.__interpolate=function(e,t,n){var r=e.split("|"),i=r[0]||"",s;return r.length>1&&(e=r.shift(),s=r.shift().split(","),i="_method."+s.shift()+".call({}, "+[e].concat(s)+")"),"<%= "+(t?"_method.__escapehtml.escaping":"")+"("+(!n||n.detection!==!1?"_method.__escapehtml.detection":"")+"("+i+")"+")"+" %>"},this.__removeShell=function(t,r){var i=0;t=t.replace(e.settings.forstart,function(e,t,n,r){var n=n||"value",r=r&&r.substr(1),s="i"+i++;return"<% ~function() {for(var "+s+" in "+t+") {"+"if("+t+".hasOwnProperty("+s+")) {"+"var "+n+"="+t+"["+s+"];"+(r?"var "+r+"="+s+";":"")+" %>"}).replace(e.settings.forend,"<% }}}(); %>").replace(e.settings.ifstart,function(e,t){return"<% if("+t+") { %>"}).replace(e.settings.ifend,"<% } %>").replace(e.settings.elsestart,function(e){return"<% } else { %>"}).replace(e.settings.elseifstart,function(e,t){return"<% } else if("+t+") { %>"}).replace(e.settings.noneencode,function(e,t){return n.__interpolate(t,!1,r)}).replace(e.settings.interpolate,function(e,t){return n.__interpolate(t,!0,r)}).replace(e.settings.inlinecomment,"").replace(e.settings.rangestart,function(e,t,n,r){var s="j"+i++;return"<% ~function() {for(var "+s+"="+n+";"+s+"<"+r+";"+s+"++) {{"+"var "+t+"="+s+";"+" %>"}).replace(e.settings.include,function(e,t,n){return"<%= _method.__juicer("+t+", "+n+"); %>"});if(!r||r.errorhandling!==!1)t="<% try { %>"+t,t+='<% } catch(e) {_method.__throw("Juicer Render Exception: "+e.message);} %>';return t},this.__toNative=function(e,t){return this.__convert(e,!t||t.strip)},this.__lexicalAnalyze=function(t){var n=[],r=[],i="",s=["if","each","_","_method","console","break","case","catch","continue","debugger","default","delete","do","finally","for","function","in","instanceof","new","return","switch","this","throw","try","typeof","var","void","while","with","null","typeof","class","enum","export","extends","import","super","implements","interface","let","package","private","protected","public","static","yield","const","arguments","true","false","undefined","NaN"],o=function(e,t){if(Array.prototype.indexOf&&e.indexOf===Array.prototype.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},u=function(t,i){i=i.match(/\w+/igm)[0];if(o(n,i)===-1&&o(s,i)===-1&&o(r,i)===-1){if(typeof window!="undefined"&&typeof window[i]=="function"&&window[i].toString().match(/^\s*?function \w+\(\) \{\s*?\[native code\]\s*?\}\s*?$/i))return t;if(typeof global!="undefined"&&typeof global[i]=="function"&&global[i].toString().match(/^\s*?function \w+\(\) \{\s*?\[native code\]\s*?\}\s*?$/i))return t;if(typeof e.options._method[i]=="function"||e.options._method.hasOwnProperty(i))return r.push(i),t;n.push(i)}return t};t.replace(e.settings.forstart,u).replace(e.settings.interpolate,u).replace(e.settings.ifstart,u).replace(e.settings.elseifstart,u).replace(e.settings.include,u).replace(/[\+\-\*\/%!\?\|\^&~<>=,\(\)\[\]]\s*([A-Za-z_]+)/igm,u);for(var a=0;a<n.length;a++)i+="var "+n[a]+"=_."+n[a]+";";for(var a=0;a<r.length;a++)i+="var "+r[a]+"=_method."+r[a]+";";return"<% "+i+" %>"},this.__convert=function(e,t){var n=[].join("");return n+="",n+="var _=_||{};",n+="var _out='';_out+='",t!==!1?(n+=e.replace(/\\/g,"\\\\").replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"	").split("'").join("\\'").split("	").join("'").replace(/<%=(.+?)%>/g,"';_out+=$1;_out+='").split("<%").join("';").split("%>").join("_out+='")+"';return _out;",n):(n+=e.replace(/\\/g,"\\\\").replace(/[\r]/g,"\\r").replace(/[\t]/g,"\\t").replace(/[\n]/g,"\\n").replace(/'(?=[^%]*%>)/g,"	").split("'").join("\\'").split("	").join("'").replace(/<%=(.+?)%>/g,"';_out+=$1;_out+='").split("<%").join("';").split("%>").join("_out+='")+"';return _out.replace(/[\\r\\n]\\s+[\\r\\n]/g, '\\r\\n');",n)},this.parse=function(e,t){var i=this;if(!t||t.loose!==!1)e=this.__lexicalAnalyze(e)+e;return e=this.__removeShell(e,t),e=this.__toNative(e,t),this._render=new Function("_, _method",e),this.render=function(e,t){if(!t||t!==n.options._method)t=r(t,n.options._method);return i._render.call(this,e,t)},this}},e.compile=function(e,t){if(!t||t!==this.options)t=r(t,this.options);try{var i=this.__cache[e]?this.__cache[e]:(new this.template(this.options)).parse(e,t);if(!t||t.cache!==!1)this.__cache[e]=i;return i}catch(s){return n("Juicer Compile Exception: "+s.message),{render:function(){}}}},e.to_html=function(e,t,n){if(!n||n!==this.options)n=r(n,this.options);return this.compile(e,n).render(t,n._method)},typeof module!="undefined"&&module.exports?module.exports=e:this.juicer=e}(),define("juicer",function(e){return function(){var t,n;return t||e.juicer}}(this)),define("modules/util/history",["require"],function(require){function History(e){this.limit=3,this.key=e||"y_his",this.jsonData=null,this.cacheTime=24,this.path="/"}return History.prototype={constructor:History,setCookie:function(e,t,n,r){r=r||{};var i=e+"="+encodeURIComponent(t);if(undefined!=n){var s=new Date;s.setTime(s.getTime()+n*3600*1e3),i=i+"; expires="+s.toUTCString()}var o=[r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join("");document.cookie=i+o},getCookie:function(e){var t=document.cookie?document.cookie.split("; "):[],n="",r="";for(var i=0;i<t.length;i++){r=t[i].split("="),r[0]=r[0].replace(" ","");if(r[0]==e){n=decodeURIComponent(r[1]);break}}return n.toString()},deleteCookie:function(e){this.setCookie(e,"",-1,{path:this.path})},initRow:function(e,t,n){return'{"title":"'+e+'", "link":"'+t+'", "other":"'+n+'"}'},parse2Json:function(jsonStr){var json=[];try{json=JSON.parse(jsonStr)}catch(e){json=eval(jsonStr)}return json},add:function(e,t,n){var r=this.getCookie(this.key);if(""!=r){this.jsonData=this.parse2Json(r);for(var i=0;i<this.jsonData.length;i++)if(t==this.jsonData[i]["link"])return!1;r="["+this.initRow(e,t,n)+",";for(var s=0;s<this.limit-1;s++){if(undefined==this.jsonData[s])break;r+=this.initRow(this.jsonData[s].title,this.jsonData[s].link,this.jsonData[s].other)+","}r=r.substring(0,r.lastIndexOf(",")),r+="]"}else r="["+this.initRow(e,t,n)+"]";this.jsonData=this.parse2Json(r),this.setCookie(this.key,r,this.cacheTime,{path:this.path})},getList:function(){if(null!=this.jsonData)return this.jsonData;var e=this.getCookie(this.key);return""!=e&&(this.jsonData=this.parse2Json(e)),this.jsonData},clearHistory:function(){this.deleteCookie(this.key),this.jsonData=null}},History}),define("modules/widget/autocomplete",["require","ajax","juicer","prober","modules/util/history"],function(e){function u(e){var t=document.createEvent("MouseEvents");t.initEvent("click",!0,!0),e.dispatchEvent(t)}function a(){this.options.container.removeClass("autocompletehide"),this.options.container.html($("#autocompletenormalTpl").html()),this.iframeshim&&this.iframeshim.css({display:"block",width:"104%",height:(this.options.container.find("li").length-1)*30+3,left:-4})}function f(){var e=l().css({position:"absolute",top:"34px",display:"none"}).appendTo(this.$el.parents(".search"));return e}function l(){return $("<iframe />").attr({frameborder:0,scrolling:"no","class":"iframeshim"})}function c(e,n){return n=n||{},n.el=e,new t(n)}var t,n,r,i,s,o;return n=e("ajax"),r=e("juicer"),i=e("prober"),s=e("modules/util/history"),o=new s("yyt_search_history"),r.register("encodeURIComponent",encodeURIComponent),t=Backbone.View.extend({options:{source:"url",template:"",container:""},events:{keyup:"_keyDownUp"},initialize:function(){var e=this;this._timer=0,this._index=-1,this.$el=this.$el,this._enter(),this.$el.on("focus",_.bind(this._keyup,this)),$(document.body).on("click",function(t){$(t.target).attr("name")!="keyword"&&setTimeout(function(){e.destroy()},200)}),window.ActiveXObject||"ActiveXObject"in window?broswer_event="propertychange":broswer_event="input",this.$el.on(broswer_event,function(){e._keyup()}),this.options.container.on("click","li",function(){e._setHistory($(this),!1)}),this.iframeshim=f.call(this)},_keyDownUp:function(e){var t=$.trim(this.$el.val());if(e.keyCode!=38&&e.keyCode!=40)return t!==""&&this._setData(t),!1;var n=this.options.container.find("li");e.keyCode==38&&this._up(n),e.keyCode==40&&this._down(n)},_keyup:function(e){var t,n;n=$.trim(this.$el.val()),n==""&&a.call(this),this._setData(n)},_up:function(e){this._index>-1&&this._index--,this._index==-1&&(this._index=e.length-1);if(e.eq(this._index).hasClass("dotted")||e.eq(this._index).hasClass("h39"))this._index-=1,this._index==-1&&(this._index=e.length-1);e.removeClass("active").eq(this._index).addClass("active")},_down:function(e){this._index++,this._index==e.length&&(this._index=0);if(e.eq(this._index).hasClass("dotted")||e.eq(this._index).hasClass("h39"))this._index+=1;e.removeClass("active").eq(this._index).addClass("active")},_enter:function(){var e,t,n,r,s,o={keyWord:"",url:""},a=this;n=this.$el.parents("form"),r=$.proxy(function(s){s.preventDefault(),e=this.options.container.find("li"),e.hasClass("active")?(a._setHistory(e.eq(this._index),!1),t=e.eq(this._index).find("a")[0],i.engine.webkit?u(t):t.click(),this._index=-1,this.destroy(),this.$el.blur()):(n.off(),this.destroy(),this.$el.val()==""?n.attr("action",this.$el.data("url")):(n.attr("action","http://so.yinyuetai.com"),o.keyWord=$.trim(this.$el.val()),o.url="http://so.yinyuetai.com?keyword="+o.keyWord,a._setHistory({},o)),n.submit(),this.$el.blur(),n.on("submit",r))},this),n.on("submit",r)},_setHistory:function(e,t){var n;t?o.add(t.keyWord,"/"+t.keyWord,t.url):(e.hasClass("obvious-item")?n=e.find(".cripe h3").text():n=e.find("strong").text(),o.add($.trim(n),"/"+n,e.find("a").attr("href")))},_setData:function(e){var t=this;clearTimeout(this._timer),this._timer=setTimeout(function(){t._readDataForDB(e,t.render)},200)},_readDataForDB:function(e,t){function s(){return n.getJSON("http://soapi.yinyuetai.com/search/search-suggest-top?keyword="+$.trim(r.$el.val())+"&pageIndex=1&pageSize=1").done(function(e){!e.error&&!!e.suggestTop&&(i.suggestTop=e.suggestTop)})}function o(){return n.getJSON("http://soapi.yinyuetai.com/search/get-searchword?keyword="+$.trim(r.$el.val())+"&pageIndex=1&pageSize=7").done(function(e){!e.error&&!!e.keywords&&(i.keywords=e.keywords)})}var r=this,i={};if($.trim(r.$el.val())==="")return;$.when(o(),s()).done(function(){t(i,r)})},render:function(e,t){e.keywords.data.length<=0&&!e.suggestTop.data?$.trim(t.$el.val())!=""?t.destroy():a.call(t):(t.options.container.removeClass("autocompletehide"),t.options.container.html(r.to_html(t.options.template,e)),t.iframeshim&&t.iframeshim.css({display:"block",width:"104%",height:(t.options.container.find("li").length-1)*30+1,left:-4}))},destroy:function(){this.options.container.addClass("autocompletehide"),this.options.container.html(""),this.iframeshim&&this.iframeshim.css("display","none")}}),c}),define("modules/yinyuetai/topbar",["require","user","prober","placeholder","modules/widget/autocomplete"],function(e){function o(e,t,n){var r,i,s,o,u,a;r=0,i="",s=/[^\x00-\xff]/g,o="",u=e.replace(s,"**").length;for(a=0;a<u;a++){o=e.charAt(a).toString(),o.match(s)!=null?r+=2:r++;if(r>t)break;i+=o}return n&&u>t&&(i+="..."),i}function u(){var e=this.$el;a().css({width:"100%",height:"41px"}).insertAfter(e);var t=a().css({top:"41px",display:"none"}).appendTo(e.find(".content"));e.find(".hoverhandler").hover(function(){var e=$(this).find(".dropdownmenu");t.css({display:"block",width:e.length>0&&e.data("width")||$(this).find("li").eq(0).width(),height:e.length>0&&e.data("height")||$(this).find("li").length*33-4,left:e.length>0&&e.offset().left||$(this).offset().left})},function(){t.css({display:"none"})})}function a(){return $("<iframe />").attr({frameborder:0,scrolling:"no","class":"iframeshim"})}var t,n,r,i,s;n=e("user"),r=e("prober"),s=e("placeholder"),i=e("modules/widget/autocomplete"),t=Backbone.View.extend({initialize:function(){var e=this;$("body").on("click",".J_login",function(t){e._showLoginBox(t)}),n.isLogined()||this._notLoginHandler(),n.logined(function(){$(window).off("focus"),e._loginHandler(),e._searchReseize()}),this._menusHoverEffect(),this._searchInputFocusEffect(),this._searchReseize(),$(window).resize(function(){e._searchReseize()}),new i(e.$el.find("[name=keyword]"),{source:"//soapi.yinyuetai.com/search/smart-search",container:e.$el.find(".autocomplete"),template:$("#autocompleteTpl").html()}),(location.href.indexOf("so.yinyuetai.com")!=-1||location.href.indexOf("i.yinyuetai.com/s")!=-1)&&e.$el.find("[name=keyword]").parents("form").attr("target",""),u.call(e)},_showLoginBox:function(t){t.preventDefault(),e(["loginBox"],function(e){e.status()=="hide"?e.trigger("show"):e.trigger("hide")})},_menusHoverEffect:function(){var e;r.browser.name=="ie"&&r.browser.version==6&&(e=this.$el.find(".hoverhandler"),e.mouseenter(function(){$(this).addClass("hover")}),e.mouseleave(function(){$(this).removeClass("hover")}))},_searchInputFocusEffect:function(){var e=this.$el.find(".search");e.find("input").focus(function(){e.addClass("focus")}),e.find("input").blur(function(){e.removeClass("focus")})},_searchReseize:function(){var e,t;e=this,t=_.throttle(function(){var t,r,i,s,o,u,a,f,l;e.$el.width()<=1270?(e.$el.find(".content").css("padding","0 0 0 2px"),e.$el.find(".menus .border").css("margin","13px 0 0"),e.$el.find(".menus .link").css("padding","0 6px 0 6px")):e.$el.width()<=1420?(e.$el.find(".content").css("padding","0 0 0 4px"),e.$el.find(".menus .border").css("margin","13px 0 0"),e.$el.find(".menus .link").css("padding","0 8px 0 8px")):e.$el.width()<=1530?(e.$el.find(".content").css("padding","0 0 0 16px"),e.$el.find(".menus .border").css("margin","13px 8px 0"),e.$el.find(".menus .link").css("padding","0 10px 0 11px")):(e.$el.find(".content").css("padding","0 20px"),e.$el.find(".menus .border").css("margin","13px 13px 0"),e.$el.find(".menus .link").css("padding","0 12px 0 13px")),t=e.$el.find(".content").width(),r=e.$el.find("h1").width(),s=e.$el.find(".userinfo").width(),o=e.$el.find(".login").width(),a=e.$el.find(".search"),f=a.find(".searchbody"),l=a.find("input"),i=e.$el.find(".menus").width(),n.isLogined()?u=t-(i+r+s):u=t-(i+r+o);var c=215,h=u-100;h>c&&(h=c),a.width(h),f.width(h-30),l.width(h-45);var p=(u-h-50)/2;p<2&&(p=2),a.css("margin-right",p),a.removeClass("hide")},200),t()},_notLoginHandler:function(){var t,r;r=this,t=0,$(window).on("focus",function(){n.emit(),n.isLogined()&&t==0&&(t=1,e(["loginBox"],function(e){e.status()=="show"&&r.$el.find(".J_login").click()}))})},_loginHandler:function(){var t,r,i;t=this.$el.find(".userinfo"),r=this.$el.find(".decoration"),i=this.$el.find(".login").eq(0),t.find(".user span").text(o(n.get("userName"),10)).attr("title",n.get("userName")),r.attr("href",r.attr("href").replace("userId",n.get("userId"))),i.addClass("hide"),t.removeClass("hide"),$(function(){setTimeout(function(){e(["modules/yinyuetai/messenger"],function(){})},5e3)})}}),new t({el:$(".topbar")})}),define("modules/util/str",["require","exports","module"],function(e,t,n){n.exports={getLength:function(e){var t=0,n=e.length;while(n--)/^[\u0000-\u00ff]$/.test(e.charAt(n))?t+=1:t+=2;return t}}});